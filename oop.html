<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>æ ªå¼ä¼šç¤¾ãƒŠã‚¬ã‚» å¿œå‹Ÿè€…æƒ…å ±æå‡ºã‚·ãƒ¼ãƒˆ ä½œæˆç”¨ãƒ•ã‚©ãƒ¼ãƒ </title>

    <!-- å¤–éƒ¨CDNä¾å­˜é–¢ä¿‚ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼‰ -->

    <!-- ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼æ¤œå‡ºã¨JavaScriptåˆ¶é™ãƒã‚§ãƒƒã‚¯ -->
    <script>
      // ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼æ¤œå‡ºã¨JavaScriptåˆ¶é™ãƒã‚§ãƒƒã‚¯
      function checkBrowserCompatibility() {
        const warnings = [];

        // User-Agentæ–‡å­—åˆ—ã‚’å–å¾—
        const userAgent = navigator.userAgent;

        // Internet Explorer ã®æ¤œå‡º
        if (userAgent.indexOf("MSIE") !== -1 || userAgent.indexOf("Trident") !== -1) {
          warnings.push("Internet Explorerã¯éå¯¾å¿œã§ã™ã€‚Google Chromeãªã©ã®æœ€æ–°ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚");
        }

        // å¤ã„Edge ã®æ¤œå‡ºï¼ˆChromiumãƒ™ãƒ¼ã‚¹ä»¥å‰ï¼‰
        if (userAgent.indexOf("Edge/") !== -1 && userAgent.indexOf("Edg/") === -1) {
          warnings.push("å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Microsoft Edgeã¯éå¯¾å¿œã§ã™ã€‚æœ€æ–°ç‰ˆã®Google Chromeã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚");
        }

        // å¤ã„Firefox ã®æ¤œå‡ºï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³60æœªæº€ï¼‰
        const firefoxMatch = userAgent.match(/Firefox\/(\d+)/);
        if (firefoxMatch && parseInt(firefoxMatch[1]) < 60) {
          warnings.push("å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Firefoxã¯éå¯¾å¿œã§ã™ã€‚æœ€æ–°ç‰ˆã®Google Chromeã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚");
        }

        // å¤ã„Safari ã®æ¤œå‡ºï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³12æœªæº€ï¼‰
        const safariMatch = userAgent.match(/Version\/(\d+)/);
        if (safariMatch && parseInt(safariMatch[1]) < 12) {
          warnings.push("å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Safariã¯éå¯¾å¿œã§ã™ã€‚æœ€æ–°ç‰ˆã®Google Chromeã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚");
        }

        // JavaScriptãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹å ´åˆã®æ¤œå‡º
        if (typeof window === "undefined" || typeof document === "undefined") {
          warnings.push("JavaScriptãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®è¨­å®šã§JavaScriptã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„ã€‚");
        }

        // ãƒ¢ãƒ€ãƒ³ãªJavaScriptæ©Ÿèƒ½ã®ã‚µãƒãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯
        if (typeof Promise === "undefined") {
          warnings.push(
            "ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯ãƒ¢ãƒ€ãƒ³ãªJavaScriptæ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚Google Chromeãªã©ã®æœ€æ–°ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚"
          );
        }

        if (typeof fetch === "undefined") {
          warnings.push(
            "ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚Google Chromeãªã©ã®æœ€æ–°ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚"
          );
        }

        return warnings;
      }

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼äº’æ›æ€§ã‚’ãƒã‚§ãƒƒã‚¯
      window.addEventListener("load", function () {
        const warnings = checkBrowserCompatibility();

        if (warnings.length > 0) {
          // è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
          const warningDiv = document.getElementById("browser-warning");
          if (warningDiv) {
            let warningHTML = '<div class="browser-warning-content">';
            warningHTML += "<h3>âš ï¸ ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼äº’æ›æ€§ã®å•é¡Œ</h3>";
            warningHTML +=
              "<p>ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã¾ãŸã¯è¨­å®šã«ã‚ˆã‚Šã€ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ãŒæ­£å¸¸ã«å‹•ä½œã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š</p>";
            warningHTML += "<ul>";
            warnings.forEach((warning) => {
              warningHTML += `<li>${warning}</li>`;
            });
            warningHTML += "</ul>";
            warningHTML += '<div class="browser-warning-actions">';
            warningHTML += "<p><strong>æ¨å¥¨ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ï¼š</strong></p>";
            warningHTML += "<ul>";
            warningHTML += "<li>Google Chromeï¼ˆæœ€æ–°ç‰ˆï¼‰</li>";
            warningHTML += "<li>Microsoft Edgeï¼ˆæœ€æ–°ç‰ˆï¼‰</li>";
            warningHTML += "</ul>";
            warningHTML +=
              '<button type="button" onclick="hideBrowserWarning()" class="warning-close-btn">ã“ã®è­¦å‘Šã‚’é–‰ã˜ã‚‹</button>';
            warningHTML += "</div>";
            warningHTML += "</div>";

            warningDiv.innerHTML = warningHTML;
            warningDiv.style.display = "block";
          }
        }
      });

      // è­¦å‘Šã‚’é–‰ã˜ã‚‹é–¢æ•°
      function hideBrowserWarning() {
        const warningDiv = document.getElementById("browser-warning");
        if (warningDiv) {
          warningDiv.style.display = "none";
        }
      }
    </script>

    <!-- çµ±åˆã•ã‚ŒãŸCSS -->
    <style>
      /* ãƒ¡ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ */
      .Form {
        margin-top: 80px;
        margin-left: auto;
        margin-right: auto;
        max-width: 720px;
        padding: 0 20px;
        box-sizing: border-box;
      }

      /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
      .Form-Header {
        text-align: center;
        margin-bottom: 20px;
        margin-top: 40px;
        color: #009380;
      }

      /* å„ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ã‚¤ãƒ†ãƒ  */
      .Form-Item {
        border-top: 1px solid #ddd;
        padding-top: 15px;
        padding-bottom: 15px;
        width: 100%;
        display: flex;
        margin-bottom: 0;
        flex-wrap: wrap;
        flex-direction: column;
      }

      /* ãƒ©ãƒ™ãƒ«é–¢é€£ */
      .Form-Item-Label {
        display: flex;
        align-items: center;
        flex: none;
        letter-spacing: 0.05em;
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 12px;
        flex-wrap: wrap;
        gap: 8px;
        line-height: 1.4;
      }

      /* å…¥åŠ›æ¬„ */
      .Form-Item-Input {
        border: 1px solid #ddd;
        align-items: center;
        border-radius: 6px;
        padding-left: 1em;
        padding-right: 1em;
        height: 48px;
        width: 100%;
        background: #eaedf2;
        font-size: 18px;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
        box-sizing: border-box;
      }

      /* ã‚¨ãƒ©ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° */
      .Form-Item-Input.error {
        border-color: #dc3545;
        background-color: #f8d7da;
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
      }

      /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠ */
      .radio-container > div,
      .checkbox-container > div {
        margin-bottom: 8px;
      }

      /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹æœ¬ä½“ã‚’éè¡¨ç¤º */
      input[type="radio"],
      input[type="checkbox"] {
        position: absolute;
        opacity: 0;
        cursor: pointer;
        height: 0;
        width: 0;
      }

      /* ãƒ©ãƒ™ãƒ«ã‚’ãƒœã‚¿ãƒ³é¢¨ã«ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° */
      input[type="radio"] + label,
      input[type="checkbox"] + label {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        border: 2px solid #ddd;
        border-radius: 8px;
        background-color: #fff;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 16px;
        line-height: 1.4;
        position: relative;
        margin: 0;
        min-height: 20px;
      }

      /* ãƒ›ãƒãƒ¼æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      input[type="radio"] + label:hover,
      input[type="checkbox"] + label:hover {
        border-color: #009380;
        background-color: #f8fffe;
      }

      /* é¸æŠæ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      input[type="radio"]:checked + label,
      input[type="checkbox"]:checked + label {
        background-color: #009380;
        border-color: #009380;
        color: #fff;
        font-weight: bold;
      }

      /* ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã®ãƒ™ãƒ¼ã‚¹ */
      input[type="radio"] + label::before,
      input[type="checkbox"] + label::before {
        content: "";
        position: absolute;
        left: 12px;
        width: 18px;
        height: 18px;
        border: 2px solid #ccc;
        background-color: #fff;
        transition: all 0.3s ease;
      }

      /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆä¸¸ï¼‰ */
      input[type="radio"] + label::before {
        border-radius: 50%;
      }

      /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆå››è§’ï¼‰ */
      input[type="checkbox"] + label::before {
        border-radius: 4px;
      }

      /* é¸æŠæ™‚ã®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
      input[type="radio"]:checked + label::before,
      input[type="checkbox"]:checked + label::before {
        border-color: #fff;
        background-color: #fff;
      }

      /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³é¸æŠæ™‚ã®å†…å´ã®ç‚¹ */
      input[type="radio"]:checked + label::after {
        content: "";
        position: absolute;
        left: 16.9px;
        top: 50%;
        transform: translateY(-50%);
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: #009380;
      }

      /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹é¸æŠæ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ */
      input[type="checkbox"]:checked + label::after {
        content: "âœ“";
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: #009380;
        font-weight: bold;
        font-size: 22px;
      }

      /* ãƒ©ãƒ™ãƒ«ãƒ†ã‚­ã‚¹ãƒˆã®å·¦ãƒãƒ¼ã‚¸ãƒ³èª¿æ•´ */
      input[type="radio"] + label,
      input[type="checkbox"] + label {
        padding-left: 45px;
      }

      /* ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      input[type="radio"].error + label,
      input[type="checkbox"].error + label {
        border-color: #dc3545;
        background-color: #f8d7da;
        color: #721c24;
      }

      /* ã‚¨ãƒ©ãƒ¼æ™‚ã‹ã¤é¸æŠæ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      input[type="radio"]:checked.error + label,
      input[type="checkbox"]:checked.error + label {
        background-color: #dc3545;
        border-color: #dc3545;
        color: #fff;
      }

      .error-message {
        color: #dc3545;
        font-size: 12px;
        margin-top: 5px;
        display: none;
      }

      /* å¿…é ˆãƒ©ãƒ™ãƒ« */
      .required-label {
        color: #dc3545;
        font-size: 12px;
        font-weight: bold;
        background-color: #fff;
        border: 1px solid #dc3545;
        border-radius: 3px;
        padding: 2px 6px;
        margin-left: 8px;
      }

      /* ãƒœã‚¿ãƒ³ */
      .submit-button {
        border-radius: 6px;
        margin: 20px auto;
        padding: 12px 24px;
        display: block;
        letter-spacing: 0.05em;
        background: #009380;
        color: #fff;
        font-weight: bold;
        font-size: 18px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .submit-button:hover {
        background-color: #006b5a;
        transform: translateY(-2px);
      }

      .back-button {
        background-color: #6c757d;
      }

      .back-button:hover {
        background-color: #5a6268;
        transform: translateY(-2px);
      }

      /* ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
      .validation-errors {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        border-radius: 6px;
        padding: 16px;
        margin: 20px 0;
        color: #721c24;
        display: none;
      }

      fieldset {
        border: 2px solid #009380;
        border-radius: 8px;
        padding: 24px;
        margin-bottom: 30px;
        background-color: #f8f9fa;
      }

      legend {
        background-color: #009380;
        color: white;
        padding: 10px 16px;
        border-radius: 4px;
        font-weight: bold;
      }

      .Form-Item-Input-Wrapper {
        flex: 1;
        width: 100%;
      }

      .name-input-wrapper {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .name-input-field {
        flex: 1 1 calc(50% - 5px);
        min-width: 140px;
      }

      /* æ³¨æ„æ›¸ããƒœãƒƒã‚¯ã‚¹ */
      .info-box {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 15px;
        font-size: 14px;
        color: #856404;
      }

      /* éƒµä¾¿ç•ªå·æ¤œç´¢ãƒœã‚¿ãƒ³ */
      .postal-search-container {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: flex-start;
      }

      .postal-input-container {
        flex: 1;
        min-width: 200px;
      }

      .search-address-btn {
        padding: 12px 16px;
        font-size: 14px;
        white-space: nowrap;
        min-width: 100px;
        height: 48px;
        border: none;
        border-radius: 6px;
        background-color: #009380;
        color: white;
        cursor: pointer;
      }

      /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠ */
      .radio-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .checkbox-container {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      /* ç¢ºèªç”»é¢ */
      .confirmation-header {
        text-align: center;
        color: #333;
        border-bottom: 2px solid #ccc;
        padding-bottom: 10px;
      }

      .confirmation-content {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }

      .confirmation-table {
        width: 100%;
        border-collapse: collapse;
      }

      .confirmation-table tr {
        border-bottom: 1px solid #ddd;
      }

      .confirmation-table td:first-child {
        padding: 8px;
        font-weight: bold;
        background: #f1f1f1;
        width: 30%;
      }

      .confirmation-table td:last-child {
        padding: 8px;
      }

      /* é€šçŸ¥ãƒœãƒƒã‚¯ã‚¹ */
      .notification-box {
        border-radius: 6px;
        padding: 15px;
        margin: 20px 0;
        text-align: center;
      }

      .notification-success {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
      }

      .notification-info {
        background-color: #d1ecf1;
        border: 1px solid #bee5eb;
        color: #0c5460;
      }

      .notification-error {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
      }

      .notification-title {
        font-weight: bold;
        margin-bottom: 5px;
      }

      .notification-filename {
        font-size: 14px;
        margin-bottom: 5px;
      }

      .notification-details {
        font-size: 12px;
        color: #666;
        line-height: 1.4;
      }

      /* ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
      .button-container {
        text-align: center;
        margin-top: 20px;
      }

      /* ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
      .browser-warning {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background-color: #fff3cd;
        border: 2px solid #ffc107;
        border-top: none;
        z-index: 10000;
        display: none;
        max-height: 80vh;
        overflow-y: auto;
      }

      .browser-warning-content {
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
      }

      .browser-warning-content h3 {
        color: #856404;
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 18px;
      }

      .browser-warning-content p {
        color: #856404;
        margin-bottom: 10px;
        line-height: 1.5;
      }

      .browser-warning-content ul {
        color: #856404;
        margin-bottom: 15px;
        padding-left: 20px;
      }

      .browser-warning-content li {
        margin-bottom: 5px;
        line-height: 1.4;
      }

      .browser-warning-actions {
        background-color: #fff;
        border: 1px solid #ffc107;
        border-radius: 6px;
        padding: 15px;
        margin-top: 15px;
      }

      .browser-warning-actions p {
        margin-bottom: 8px;
      }

      .browser-warning-actions ul {
        margin-bottom: 15px;
      }

      .warning-close-btn {
        background-color: #6c757d;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s ease;
      }

      .warning-close-btn:hover {
        background-color: #5a6268;
      }

      @media screen and (max-width: 480px) {
        .Form {
          margin-top: 40px;
          padding: 0 10px;
        }
        .Form-Item {
          padding: 16px;
        }
        .Form-Item-Label {
          font-size: 16px;
        }
        .Form-Item-Input {
          height: 44px;
          font-size: 16px;
        }
        .name-input-wrapper {
          flex-direction: column;
        }
        .name-input-field {
          flex: 1 1 100%;
          min-width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <!-- ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
    <div id="browser-warning" class="browser-warning"></div>

    <form id="MainForm" name="MainForm">
      <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
      <div class="Form-Header">
        <h1>æ ªå¼ä¼šç¤¾ãƒŠã‚¬ã‚» <br />å¿œå‹Ÿè€…æƒ…å ±æå‡ºã‚·ãƒ¼ãƒˆ ä½œæˆç”¨ãƒ•ã‚©ãƒ¼ãƒ </h1>
      </div>

      <!-- JavaScriptãŒç„¡åŠ¹ãªå ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
      <noscript>
        <div
          style="
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 20px;
            margin: 20px;
            color: #721c24;
            text-align: center;
          "
        >
          <h3>âš ï¸ JavaScriptãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™</h3>
          <p>ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã¯æ­£å¸¸ã«å‹•ä½œã™ã‚‹ãŸã‚ã«JavaScriptãŒå¿…è¦ã§ã™ã€‚</p>
          <p>ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®è¨­å®šã§JavaScriptã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„ã€‚</p>
          <p><strong>æ¨å¥¨ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ï¼š</strong></p>
          <ul style="list-style: none; padding: 0">
            <li>Google Chromeï¼ˆæœ€æ–°ç‰ˆï¼‰</li>
            <li>Microsoft Edgeï¼ˆæœ€æ–°ç‰ˆï¼‰</li>
            <li>Firefoxï¼ˆæœ€æ–°ç‰ˆï¼‰</li>
            <li>Safariï¼ˆæœ€æ–°ç‰ˆï¼‰</li>
          </ul>
        </div>
      </noscript>

      <!-- ãƒ•ã‚©ãƒ¼ãƒ  -->
      <div class="Form">
        <!-- ã‚ãªãŸã«ã¤ã„ã¦ -->
        <fieldset>
          <legend>ã‚ãªãŸã«ã¤ã„ã¦</legend>

          <!-- æ°å(æ¼¢å­—) -->
          <div class="Form-Item">
            <p class="Form-Item-Label">æ°å(æ¼¢å­—)<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper name-input-wrapper">
              <div class="name-input-field">
                <input type="text" id="name_1" name="name_1" class="Form-Item-Input" placeholder="æ±é€²" required />
                <small style="color: gray">å§“</small>
                <div class="error-message" id="name_1_error"></div>
              </div>
              <div class="name-input-field">
                <input type="text" id="name_2" name="name_2" class="Form-Item-Input" placeholder="å¤ªéƒ" required />
                <small style="color: gray">å</small>
                <div class="error-message" id="name_2_error"></div>
              </div>
            </div>
          </div>

          <!-- æ°å(ã‚«ãƒŠ) -->
          <div class="Form-Item">
            <p class="Form-Item-Label">æ°å(ã‚«ãƒŠ)<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper name-input-wrapper">
              <div class="name-input-field">
                <input
                  type="text"
                  id="name_1_kana"
                  name="name_1_kana"
                  class="Form-Item-Input"
                  placeholder="ï¾„ï½³ï½¼ï¾"
                  required
                />
                <small style="color: gray">ï½¾ï½²</small>
                <div class="error-message" id="name_1_kana_error"></div>
              </div>
              <div class="name-input-field">
                <input
                  type="text"
                  id="name_2_kana"
                  name="name_2_kana"
                  class="Form-Item-Input"
                  placeholder="ï¾€ï¾›ï½³"
                  required
                />
                <small style="color: gray">ï¾’ï½²</small>
                <div class="error-message" id="name_2_kana_error"></div>
              </div>
            </div>
          </div>

          <!-- æ€§åˆ¥ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">æ€§åˆ¥<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <select id="id_sex" name="id_sex" class="Form-Item-Input" required>
                <option value="">--é¸æŠã—ã¦ãã ã•ã„--</option>
                <option value="1">ç”·æ€§</option>
                <option value="2">å¥³æ€§</option>
              </select>
              <div class="error-message" id="id_sex_error"></div>
            </div>
          </div>

          <!-- ç”Ÿå¹´æœˆæ—¥ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">ç”Ÿå¹´æœˆæ—¥<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input type="date" id="birthday" name="birthday" class="Form-Item-Input" required />
              <div class="error-message" id="birthday_error"></div>
            </div>
          </div>

          <!-- éƒµä¾¿ç•ªå· -->
          <div class="Form-Item">
            <p class="Form-Item-Label">éƒµä¾¿ç•ªå·<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <div class="postal-search-container">
                <div class="postal-input-container">
                  <input
                    type="text"
                    id="address_num"
                    name="address_num"
                    class="Form-Item-Input"
                    placeholder="1800003"
                    maxlength="7"
                    required
                  />
                </div>
                <button type="button" id="search_address_btn" class="search-address-btn">ä½æ‰€æ¤œç´¢</button>
              </div>
              <small>â€»éƒµä¾¿ç•ªå·ã¯ãƒã‚¤ãƒ•ãƒ³ãªã—ã®åŠè§’æ•°å­—7æ¡ã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="address_num_error"></div>
            </div>
          </div>

          <!-- ä½æ‰€ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">ä½æ‰€<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="address_str"
                name="address_str"
                class="Form-Item-Input"
                placeholder="æ±äº¬éƒ½æ­¦è”µé‡å¸‚å‰ç¥¥å¯ºå—ç”ºï¼‘ä¸ç›®ï¼’ï¼™âˆ’ï¼’"
                required
              />
              <div class="error-message" id="address_str_error"></div>
            </div>
          </div>

          <!-- å»ºç‰©åãƒ»éƒ¨å±‹ç•ªå· -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å»ºç‰©åãƒ»éƒ¨å±‹ç•ªå·</p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="address_str_building"
                name="address_str_building"
                class="Form-Item-Input"
                placeholder="ãƒŠã‚¬ã‚»å‰ç¥¥å¯ºå—ç”ºãƒ“ãƒ«ï¼’ï¼ï¼‘å·å®¤"
              />
            </div>
          </div>

          <!-- ä½æ‰€å»ºç‰©åãƒ•ãƒªã‚¬ãƒŠ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">ä½æ‰€å»ºç‰©åãƒ•ãƒªã‚¬ãƒŠ<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="address_str_kana"
                name="address_str_kana"
                class="Form-Item-Input"
                placeholder="ï¾„ï½³ï½·ï½®ï½³ï¾„ï¾‘ï½»ï½¼ï¾‰ï½¼ï½·ï¾ï½¼ï¾ï½®ï½³ï½¼ï¾ï¾ï¾…ï¾ï¾ï¾ï¾…ï½¶ï¾ï½¾ï½·ï¾ï½¼ï¾ï½®ï½³ï½¼ï¾ï¾ï¾…ï¾ï¾ï¾ï¾‹ï¾ï¾™"
                required
              />
              <small>â€»åŠè§’ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="address_str_kana_error"></div>
            </div>
          </div>

          <!-- é›»è©±ç•ªå·(è‡ªå®…) -->
          <div class="Form-Item">
            <p class="Form-Item-Label">é›»è©±ç•ªå·(è‡ªå®…)<span class="required-label">ã„ãšã‚Œã‹å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input type="text" id="tel_home" name="tel_home" class="Form-Item-Input" placeholder="0422-45-7011" />
              <small>â€»ãƒã‚¤ãƒ•ãƒ³åŒºåˆ‡ã‚Šã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="tel_home_error"></div>
            </div>
          </div>

          <!-- é›»è©±ç•ªå·(æºå¸¯) -->
          <div class="Form-Item">
            <p class="Form-Item-Label">é›»è©±ç•ªå·(æºå¸¯)<span class="required-label">ã„ãšã‚Œã‹å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="tel_mobile"
                name="tel_mobile"
                class="Form-Item-Input"
                placeholder="090-1234-5678"
              />
              <small>â€»ãƒã‚¤ãƒ•ãƒ³åŒºåˆ‡ã‚Šã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="tel_mobile_error"></div>
            </div>
          </div>

          <!-- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="email"
                id="email_address"
                name="email_address"
                class="Form-Item-Input"
                placeholder="example@domain.com"
                required
              />
              <div class="error-message" id="email_address_error"></div>
            </div>
          </div>
        </fieldset>

        <!-- å­¦æ­´ã«ã¤ã„ã¦ -->
        <div class="Form-Item">
          <p class="Form-Item-Label">æœ€çµ‚å­¦æ­´<span class="required-label">å¿…é ˆ</span></p>
          <div class="Form-Item-Input-Wrapper">
            <div class="radio-container">
              <div>
                <input type="radio" id="education_level_1" name="education_level" value="1" required />
                <label for="education_level_1">å¤§å­¦ãƒ»å¤§å­¦é™¢ã‚’å’æ¥­ã¾ãŸã¯åœ¨å­¦ä¸­ã€å¤§å­¦ã«å…¥å­¦äºˆå®š</label>
              </div>
              <div>
                <input type="radio" id="education_level_2" name="education_level" value="2" required />
                <label for="education_level_2">çŸ­æœŸå¤§å­¦ãƒ»å°‚é–€å­¦æ ¡ã‚’å’æ¥­ã¾ãŸã¯åœ¨å­¦ä¸­</label>
              </div>
              <div>
                <input type="radio" id="education_level_3" name="education_level" value="3" required />
                <label for="education_level_3">é«˜æ ¡ã‚’å’æ¥­ã¾ãŸã¯åœ¨å­¦ä¸­ï¼ˆå¤§å­¦ãƒ»çŸ­å¤§ãƒ»å°‚é–€å­¦æ ¡ã«ã¯å…¥å­¦äºˆå®šãªã—ï¼‰</label>
              </div>
              <div>
                <input type="radio" id="education_level_4" name="education_level" value="4" required />
                <label for="education_level_4">ä¸­å­¦æ ¡å’æ¥­ï¼ˆé«˜æ ¡ä»¥ä¸Šã«ã¯é€²å­¦ã—ã¦ã„ãªã„ï¼‰</label>
              </div>
            </div>
            <div class="error-message" id="education_level_error"></div>
          </div>
        </div>

        <!-- å¤§å­¦ã«ã¤ã„ã¦ -->
        <fieldset>
          <legend>å¤§å­¦ã«ã¤ã„ã¦</legend>
          <div class="info-box">
            å¤§å­¦ã«å…¥å­¦äºˆå®šã®æ–¹ã¯ã€ç¾åœ¨å…¥å­¦äºˆå®šã®å¤§å­¦ã¨å…¥å­¦äºˆå®šå¹´æœˆæ—¥ã‚’ãŠç­”ãˆãã ã•ã„ã€‚<br />
            æ—¢ã«å¤§å­¦ã‚’å’æ¥­ã•ã‚ŒãŸæ–¹ã¯ã€å‡ºèº«å¤§å­¦ã‚’ä¸€ã¤ãŠç­”ãˆãã ã•ã„ã€‚<br />
          </div>

          <!-- å¤§å­¦å -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å¤§å­¦<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input type="text" id="daigaku" name="daigaku" class="Form-Item-Input" placeholder="æ±äº¬å¤§å­¦" required />
              <small>â€»æœ€å¾Œã«ã€Œå¤§å­¦ã€ã¨ä»˜ã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</small>
              <div class="error-message" id="daigaku_error"></div>
            </div>
          </div>

          <!-- å­¦éƒ¨ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å­¦éƒ¨ãƒ»å­¦é¡ãƒ»ç§‘é¡ç­‰<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="gakubu"
                name="gakubu"
                class="Form-Item-Input"
                placeholder="ç†å­¦éƒ¨ã¾ãŸã¯ç†ç§‘ä¸€é¡"
                required
              />
              <small>â€»å­¦éƒ¨ãƒ»å­¦é¡ãƒ»ç§‘é¡ç­‰ã®åç§°ã‚’ãã®ã¾ã¾å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹ï¼šç†å­¦éƒ¨ã€ç†ç§‘ä¸€é¡ã€æ–‡å­¦éƒ¨ç­‰ï¼‰</small>
              <div class="error-message" id="gakubu_error"></div>
            </div>
          </div>

          <!-- å­¦ç§‘ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å­¦ç§‘<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input type="text" id="gakka" name="gakka" class="Form-Item-Input" placeholder="æ•°å­¦ç§‘" required />
              <small
                >â€»æœ€å¾Œã«ã€Œå­¦ç§‘ã€ã¨ä»˜ã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br />â€»å­¦ç§‘ãŒãªã„å ´åˆã¯ã€Œãªã—ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</small
              >
              <div class="error-message" id="gakka_error"></div>
            </div>
          </div>

          <!-- å¤§å­¦å…¥å­¦å¹´æœˆæ—¥ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å…¥å­¦å¹´æœˆæ—¥<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input type="date" id="daigaku_nyugaku_bi" name="daigaku_nyugaku_bi" class="Form-Item-Input" required />
              <div class="error-message" id="daigaku_nyugaku_bi_error"></div>
            </div>
          </div>

          <!-- å¤§å­¦é™¢å -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å¤§å­¦é™¢</p>
            <div class="Form-Item-Input-Wrapper">
              <input type="text" id="daigakuin" name="daigakuin" class="Form-Item-Input" placeholder="æ±äº¬å¤§å­¦å¤§å­¦é™¢" />
              <small>â€»æœ€å¾Œã«ã€Œå¤§å­¦å¤§å­¦é™¢ã€ã¨ä»˜ã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</small>
            </div>
          </div>

          <!-- ç ”ç©¶ç§‘ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">ç ”ç©¶ç§‘</p>
            <div class="Form-Item-Input-Wrapper">
              <input type="text" id="kenkyuka" name="kenkyuka" class="Form-Item-Input" placeholder="ç†å­¦ç³»ç ”ç©¶ç§‘" />
              <small>â€»æœ€å¾Œã«ã€Œç ”ç©¶ç§‘ã€ã¨ä»˜ã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</small>
            </div>
          </div>

          <!-- å°‚æ”» -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å°‚æ”»</p>
            <div class="Form-Item-Input-Wrapper">
              <input type="text" id="senkou" name="senkou" class="Form-Item-Input" placeholder="ç‰©ç†å­¦å°‚æ”»" />
              <small>â€»æœ€å¾Œã«ã€Œå°‚æ”»ã€ã¨ä»˜ã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</small>
            </div>
          </div>
        </fieldset>

        <!-- å‡ºèº«é«˜æ ¡ -->
        <div class="Form-Item">
          <p class="Form-Item-Label">å‡ºèº«é«˜æ ¡<span class="required-label">å¿…é ˆ</span></p>
          <div class="Form-Item-Input-Wrapper">
            <input
              type="text"
              id="koukou_name"
              name="koukou_name"
              class="Form-Item-Input"
              placeholder="ã€‡ã€‡é«˜æ ¡"
              required
            />
            <div class="error-message" id="koukou_name_error"></div>
          </div>
        </div>

        <!-- æ±é€²åœ¨ç±æ­´ -->
        <div class="Form-Item">
          <p class="Form-Item-Label">æ±é€²åœ¨ç±æ­´<span class="required-label">å¿…é ˆ</span></p>
          <div class="Form-Item-Input-Wrapper">
            <div class="radio-container">
              <div>
                <input type="radio" id="toshin_zaisekireki_1" name="toshin_zaisekireki" value="1" required />
                <label for="toshin_zaisekireki_1"
                  >æ±é€²ãƒã‚¤ã‚¹ã‚¯ãƒ¼ãƒ«ãƒ»æ±é€²è¡›æ˜Ÿäºˆå‚™æ ¡ãƒ»æ±å¤§ç‰¹é€²ã®ã„ãšã‚Œã‹ã«åœ¨ç±æ­´ãŒã‚ã‚‹</label
                >
              </div>
              <div>
                <input type="radio" id="toshin_zaisekireki_2" name="toshin_zaisekireki" value="2" required />
                <label for="toshin_zaisekireki_2">åœ¨ç±æ­´ã¯ãªã„</label>
              </div>
            </div>
            <div class="error-message" id="toshin_zaisekireki_error"></div>
          </div>
        </div>

        <!-- çµ¦ä¸å—å–å£åº§ã«ã¤ã„ã¦ -->
        <fieldset>
          <legend>çµ¦ä¸å—å–å£åº§ã«ã¤ã„ã¦</legend>
          <div class="info-box">å¿…ãšå¿œå‹Ÿè€…æœ¬äººåç¾©ã®å£åº§ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
          <!-- éŠ€è¡Œã‚³ãƒ¼ãƒ‰ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">éŠ€è¡Œã‚³ãƒ¼ãƒ‰<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="bank_code"
                name="bank_code"
                class="Form-Item-Input"
                maxlength="4"
                placeholder="0001"
                required
              />
              <small>â€»4æ¡ã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="bank_code_error"></div>
            </div>
          </div>

          <!-- éŠ€è¡Œå -->
          <div class="Form-Item">
            <p class="Form-Item-Label">éŠ€è¡Œå<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="bank_name"
                name="bank_name"
                class="Form-Item-Input"
                placeholder="ã¿ãšã»éŠ€è¡Œ"
                required
              />
              <small>â€»ã€ŒéŠ€è¡Œã€ã€Œä¿¡ç”¨é‡‘åº«ã€ç­‰ã‚’å«ã‚ã¦å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="bank_name_error"></div>
            </div>
          </div>

          <!-- æ”¯åº—ã‚³ãƒ¼ãƒ‰ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">æ”¯åº—ã‚³ãƒ¼ãƒ‰<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="branch_code"
                name="branch_code"
                class="Form-Item-Input"
                maxlength="3"
                placeholder="001"
                required
              />
              <small>â€»3æ¡ã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="branch_code_error"></div>
            </div>
          </div>

          <!-- æ”¯åº—å -->
          <div class="Form-Item">
            <p class="Form-Item-Label">æ”¯åº—å<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="branch_name"
                name="branch_name"
                class="Form-Item-Input"
                placeholder="æ±äº¬æ”¯åº—"
                required
              />
              <small>â€»ã€Œæ”¯åº—ã€ã€Œå‡ºå¼µæ‰€ã€ç­‰ã‚’å«ã‚ã¦å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="branch_name_error"></div>
            </div>
          </div>

          <!-- å£åº§ç¨®åˆ¥ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å£åº§ç¨®åˆ¥<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <select id="account_type" name="account_type" class="Form-Item-Input" required>
                <option value="">--é¸æŠã—ã¦ãã ã•ã„--</option>
                <option value="1">æ™®é€šé é‡‘</option>
                <option value="2">å½“åº§é é‡‘</option>
              </select>
              <div class="error-message" id="account_type_error"></div>
            </div>
          </div>

          <!-- å£åº§ç•ªå· -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å£åº§ç•ªå·<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="account_number"
                name="account_number"
                class="Form-Item-Input"
                maxlength="8"
                placeholder="1234567"
                required
              />
              <small>â€»åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆæ™®é€šé é‡‘ï¼šæœ€å¤§7æ¡ã€å½“åº§é é‡‘ï¼šæœ€å¤§8æ¡ï¼‰</small>
              <div class="error-message" id="account_number_error"></div>
            </div>
          </div>

          <!-- å£åº§åç¾©äºº -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å£åº§åç¾©äºº<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="account_holder"
                name="account_holder"
                class="Form-Item-Input"
                placeholder="æ±é€²å¤ªéƒ"
                required
              />
              <small>â€»å¿…ãšå¿œå‹Ÿè€…æœ¬äººåç¾©ã®å£åº§ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="account_holder_error"></div>
            </div>
          </div>

          <!-- å£åº§åç¾©äººãƒ•ãƒªã‚¬ãƒŠ -->
          <div class="Form-Item">
            <p class="Form-Item-Label">å£åº§åç¾©äººãƒ•ãƒªã‚¬ãƒŠ<span class="required-label">å¿…é ˆ</span></p>
            <div class="Form-Item-Input-Wrapper">
              <input
                type="text"
                id="account_holder_kana"
                name="account_holder_kana"
                class="Form-Item-Input"
                placeholder="ï¾„ï½³ï½¼ï¾ï¾€ï¾›ï½³"
                required
              />
              <small>â€»å¿…ãšå¿œå‹Ÿè€…æœ¬äººåç¾©ã®å£åº§ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„<br />â€»åŠè§’ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
              <div class="error-message" id="account_holder_kana_error"></div>
            </div>
          </div>
        </fieldset>

        <!-- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="validation-errors" class="validation-errors">
          <div class="validation-errors-header">
            <strong>âš ï¸ å…¥åŠ›å†…å®¹ã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ä¿®æ­£ã—ã¦ã‹ã‚‰å†åº¦ç¢ºèªãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</strong>
          </div>
          <div id="validation-errors-list"></div>
        </div>

        <!-- ç¢ºèªãƒœã‚¿ãƒ³ -->
        <button type="button" id="confirm-button" class="submit-button">å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã™ã‚‹</button>
      </div>

      <!-- ç¢ºèªç”»é¢ -->
      <div id="confirmationScreen" style="display: none">
        <h2 class="confirmation-header">å…¥åŠ›å†…å®¹ç¢ºèª</h2>

        <div
          class="confirmation-content"
          style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0"
        >
          <div id="confirmationData"></div>
        </div>

        <!-- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€šçŸ¥ -->
        <div id="download-notification" class="notification-box notification-info" style="display: none">
          <div class="notification-title">ğŸ”„ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†å®Ÿè¡Œ</div>
          <div id="download-filename" class="notification-filename"></div>
          <div class="notification-details">
            csvãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸã€‚<br />
            ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®å¯å¦ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å…ˆã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚„ãƒ‡ãƒã‚¤ã‚¹ã®ç’°å¢ƒã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚<br />
            ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ãªã„å ´åˆã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰è¨­å®šã‚’ã”ç¢ºèªãã ã•ã„ã€‚<br />
            <span style="color: red; font-weight: bold; font-size: 14px">
              âš ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ãŸã‚Šç·¨é›†ã—ãŸã‚Šã›ãšã«ã€ãã®ã¾ã¾æ¡ç”¨æ‹…å½“è€…ã«ãŠé€ã‚Šãã ã•ã„ã€‚
            </span>
          </div>
        </div>

        <!-- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¤±æ•—é€šçŸ¥ -->
        <div id="download-error-notification" class="notification-box notification-error" style="display: none">
          <div class="notification-title">âŒ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†ã‚¨ãƒ©ãƒ¼</div>
          <div id="download-error-message" class="notification-filename" style="margin-bottom: 10px"></div>
          <div class="notification-details">
            ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†ã®å®Ÿè¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã‚’ã”ç¢ºèªãã ã•ã„ï¼š<br />
            â€¢ ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰è¨­å®š<br />
            â€¢ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å…ˆãƒ•ã‚©ãƒ«ãƒ€ã®æ›¸ãè¾¼ã¿æ¨©é™<br />
            â€¢ ãƒ–ãƒ©ã‚¦ã‚¶ã®æ‹¡å¼µæ©Ÿèƒ½ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š<br />
            â€¢ ãƒ‡ãƒã‚¤ã‚¹ã®ç©ºãå®¹é‡<br />
          </div>
        </div>

        <div class="button-container">
          <button type="button" id="back-button" class="submit-button back-button" style="margin-right: 10px">
            æˆ»ã‚‹
          </button>
          <button type="button" id="csv-button" class="submit-button">CSVã¨ã—ã¦å‡ºåŠ›</button>
        </div>
      </div>
    </form>

    <script>
            // ===== ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ  =====

            /**
             * ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚’è¡¨ã™ã‚¯ãƒ©ã‚¹
             */
            class ValidationResult {
              constructor(isValid, message = "") {
                this.isValid = isValid;
                this.message = message;
              }

              static success() {
                return new ValidationResult(true);
              }

              static error(message) {
                return new ValidationResult(false, message);
              }
            }

            /**
             * ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ã®åŸºåº•ã‚¯ãƒ©ã‚¹
             */
            class Validator {
              constructor(errorMessage) {
                this.errorMessage = errorMessage;
              }

              /**
               * ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œï¼ˆã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼‰
               * @param {string} value - å…¥åŠ›å€¤
               * @returns {ValidationResult} - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³çµæœ
               */
              validate(value) {
                throw new Error("validate method must be implemented");
              }
            }

            /**
             * å¿…é ˆãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼
             */
            class RequiredValidator extends Validator {
              constructor() {
                super("ã“ã®é …ç›®ã¯å¿…é ˆã§ã™ã€‚");
              }

              validate(value) {
                return value && value.trim() !== "" ? ValidationResult.success() : ValidationResult.error(this.errorMessage);
              }
            }

            /**
             * æ­£è¦è¡¨ç¾ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼
             */
            class RegexValidator extends Validator {
              constructor(pattern, errorMessage) {
                super(errorMessage);
                this.pattern = pattern;
              }

              validate(value) {
                if (!value || value.trim() === "") {
                  return ValidationResult.success(); // ç©ºã®å ´åˆã¯å¿…é ˆãƒã‚§ãƒƒã‚¯ã«ä»»ã›ã‚‹
                }

                return this.pattern.test(value.trim())
                  ? ValidationResult.success()
                  : ValidationResult.error(this.errorMessage);
              }
            }

            // ===== ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³å®šæ•° =====
            const VALIDATION_PATTERNS = {
              KANA: {
                regex: /^[ï½¦-ï¾Ÿ\s]+$/,
                message: "åŠè§’ã‚«ã‚¿ã‚«ãƒŠã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
              },
              POSTAL_CODE: {
                regex: /^\d{7}$/,
                message: "éƒµä¾¿ç•ªå·ã¯åŠè§’æ•°å­—7æ¡ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
              },
              MOBILE_PHONE: {
                regex: /^0[789]0-\d{4}-\d{4}$/,
                message: "æ­£ã—ã„æºå¸¯é›»è©±ç•ªå·ã®å½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹ï¼š090-1234-5678ï¼‰",
              },
              EMAIL: {
                regex: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
                message: "æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
              },
              HOME_PHONE: {
                regex: /^0\d{1,3}-\d{1,4}-\d{4}$/,
                message: "æ­£ã—ã„é›»è©±ç•ªå·ã®å½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹ï¼š03-1234-5678ï¼‰",
              },
              BANK_CODE: {
                regex: /^\d{4}$/,
                message: "éŠ€è¡Œã‚³ãƒ¼ãƒ‰ã¯4æ¡ã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
              },
              BRANCH_CODE: {
                regex: /^\d{3}$/,
                message: "æ”¯åº—ã‚³ãƒ¼ãƒ‰ã¯3æ¡ã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
              },
              ACCOUNT_NUMBER: {
                regex: /^\d{1,8}$/,
                message: "å£åº§ç•ªå·ã¯1-8æ¡ã®åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
              },
            };

            /**
             * ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å¿…é ˆãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼
             */
            class CheckboxRequiredValidator extends Validator {
              constructor(checkboxIds) {
                super("ã„ãšã‚Œã‹ã®é¸æŠè‚¢ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
                this.checkboxIds = checkboxIds;
              }

              validate(value) {
                // checkboxIdsã®ã„ãšã‚Œã‹ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                const hasChecked = this.checkboxIds.some((id) => {
                  const checkbox = document.getElementById(id);
                  return checkbox && checkbox.checked;
                });

                return hasChecked ? ValidationResult.success() : ValidationResult.error(this.errorMessage);
              }
            }

            /**
             * å£åº§åç¾©äººã®ä¸€è‡´ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ï¼ˆæ¼¢å­—ï¼‰
             */
            class AccountHolderMatchValidator extends Validator {
              constructor(name1Id, name2Id) {
                super("å£åº§åç¾©äººã¯å¿…ãšå¿œå‹Ÿè€…æœ¬äººåç¾©ã®å£åº§ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                this.name1Id = name1Id;
                this.name2Id = name2Id;
              }

              validate(value) {
                if (!value || value.trim() === "") {
                  return ValidationResult.success(); // ç©ºã®å ´åˆã¯å¿…é ˆãƒã‚§ãƒƒã‚¯ã«ä»»ã›ã‚‹
                }

                const name1Element = document.getElementById(this.name1Id);
                const name2Element = document.getElementById(this.name2Id);

                if (!name1Element || !name2Element) {
                  return ValidationResult.success();
                }

                // å…¨è§’ãƒ»åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»ã—ã¦æ¯”è¼ƒ
                const fullName = (name1Element.value.trim() + name2Element.value.trim()).replace(/[\sã€€]/g, "");
                const normalizedValue = value.trim().replace(/[\sã€€]/g, "");

                return normalizedValue === fullName ? ValidationResult.success() : ValidationResult.error(this.errorMessage);
              }
            }

            /**
             * åŠè§’ã‚«ã‚¿ã‚«ãƒŠã®å°æ–‡å­—ã‚’å¤§æ–‡å­—ã«å¤‰æ›ã™ã‚‹é–¢æ•°
             */
            function normalizeHalfWidthKana(str) {
              const kanaMap = {
                ï½§: "ï½±",
                ï½¨: "ï½²",
                ï½©: "ï½³",
                ï½ª: "ï½´",
                ï½«: "ï½µ",
                ï½¬: "ï¾”",
                ï½­: "ï¾•",
                ï½®: "ï¾–",
                ï½¯: "ï¾‚",
              };

              return str.replace(/[ï½§ï½¨ï½©ï½ªï½«ï½¬ï½­ï½®ï½¯]/g, function (match) {
                return kanaMap[match] || match;
              });
            }

            /**
             * å£åº§åç¾©äººãƒ•ãƒªã‚¬ãƒŠã®ä¸€è‡´ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼
             */
            class AccountHolderKanaMatchValidator extends Validator {
              constructor(name1KanaId, name2KanaId) {
                super("å£åº§åç¾©äººãƒ•ãƒªã‚¬ãƒŠã¯å¿…ãšå¿œå‹Ÿè€…æœ¬äººåç¾©ã®å£åº§ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                this.name1KanaId = name1KanaId;
                this.name2KanaId = name2KanaId;
              }

              validate(value) {
                if (!value || value.trim() === "") {
                  return ValidationResult.success(); // ç©ºã®å ´åˆã¯å¿…é ˆãƒã‚§ãƒƒã‚¯ã«ä»»ã›ã‚‹
                }

                const name1KanaElement = document.getElementById(this.name1KanaId);
                const name2KanaElement = document.getElementById(this.name2KanaId);

                if (!name1KanaElement || !name2KanaElement) {
                  return ValidationResult.success();
                }

                // å…¨è§’ãƒ»åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»ã—ã€å°æ–‡å­—ã‚’å¤§æ–‡å­—ã«å¤‰æ›ã—ã¦ã‹ã‚‰æ¯”è¼ƒ
                const fullNameKana = normalizeHalfWidthKana(
                  (name1KanaElement.value.trim() + name2KanaElement.value.trim()).replace(/[\sã€€]/g, "")
                );
                const normalizedValue = normalizeHalfWidthKana(value.trim().replace(/[\sã€€]/g, ""));

                return normalizedValue === fullNameKana
                  ? ValidationResult.success()
                  : ValidationResult.error(this.errorMessage);
              }
            }

            /**
             * é›»è©±ç•ªå·ç›¸äº’ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ï¼ˆè‡ªå®…ã¾ãŸã¯æºå¸¯ã®ã„ãšã‚Œã‹ã¯å¿…é ˆï¼‰
             */
            class PhoneEitherRequiredValidator extends Validator {
              constructor(homePhoneId, mobilePhoneId) {
                super("è‡ªå®…ã¾ãŸã¯æºå¸¯é›»è©±ç•ªå·ã®ã„ãšã‚Œã‹ã¯å¿…é ˆã§ã™ã€‚");
                this.homePhoneId = homePhoneId;
                this.mobilePhoneId = mobilePhoneId;
              }

              validate(value) {
                const homePhoneElement = document.getElementById(this.homePhoneId);
                const mobilePhoneElement = document.getElementById(this.mobilePhoneId);

                if (!homePhoneElement || !mobilePhoneElement) {
                  return ValidationResult.success();
                }

                const homeValue = homePhoneElement.value.trim();
                const mobileValue = mobilePhoneElement.value.trim();

                return homeValue || mobileValue ? ValidationResult.success() : ValidationResult.error(this.errorMessage);
              }
            }

            /**
             * ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¡¨ã™ã‚¯ãƒ©ã‚¹
             */
            class FormField {
              constructor(elementId, label) {
                this.elementId = elementId;
                this.label = label;
                this.element = document.getElementById(elementId);
                this.errorElement = document.getElementById(elementId + "_error");
                this.validators = [];
                this.inputTransformers = [];

                if (!this.element) {
                  console.warn(`Element with id '${elementId}' not found`);
                  return;
                }

                this.setupEventListeners();
              }

              /**
               * ãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼ã‚’è¿½åŠ 
               */
              addValidator(validator) {
                this.validators.push(validator);
                return this;
              }

              /**
               * å…¥åŠ›å¤‰æ›å™¨ã‚’è¿½åŠ ï¼ˆä¾‹ï¼šå…¨è§’â†’åŠè§’å¤‰æ›ï¼‰
               */
              addInputTransformer(transformer) {
                this.inputTransformers.push(transformer);
                return this;
              }

              /**
               * ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
               */
              setupEventListeners() {
                if (!this.element) return;

                // IMEå¤‰æ›çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãƒ•ãƒ©ã‚°
                this.isComposing = false;

                // IMEå¤‰æ›é–‹å§‹
                this.element.addEventListener("compositionstart", () => {
                  this.isComposing = true;
                });

                // IMEå¤‰æ›çµ‚äº†æ™‚ã«å¤‰æ›å‡¦ç†ã‚’å®Ÿè¡Œ
                this.element.addEventListener("compositionend", () => {
                  this.isComposing = false;
                  setTimeout(() => {
                    this.applyTransformers();
                    this.validateRealtime();
                  }, 0);
                });

                // é€šå¸¸ã®å…¥åŠ›ï¼ˆIMEä½¿ç”¨ä»¥å¤–ï¼‰ã®å ´åˆ
                this.element.addEventListener("input", () => {
                  if (!this.isComposing) {
                    this.applyTransformers();
                    this.validateRealtime();
                  }
                });

                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒå¤–ã‚ŒãŸæ™‚ã«ã‚‚å¤‰æ›å‡¦ç†ã‚’å®Ÿè¡Œï¼ˆå®‰å…¨ã®ãŸã‚ï¼‰
                this.element.addEventListener("blur", () => {
                  this.applyTransformers();
                  this.validate();
                });
              }

              /**
               * å…¥åŠ›å¤‰æ›å™¨ã‚’é©ç”¨
               */
              applyTransformers() {
                if (!this.element) return;

                let value = this.element.value;
                for (const transformer of this.inputTransformers) {
                  value = transformer(value);
                }
                this.element.value = value;
              }

              /**
               * ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå¿…é ˆãƒã‚§ãƒƒã‚¯å«ã‚€ï¼‰
               */
              validateRealtime() {
                if (!this.element) return;

                const value = this.element.value;

                // å…¨ã¦ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
                for (const validator of this.validators) {
                  const result = validator.validate(value);
                  if (!result.isValid) {
                    this.showError(result.message);
                    return;
                  }
                }

                this.hideError();
              }

              /**
               * å®Œå…¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
               */
              validate() {
                if (!this.element) return ValidationResult.success();

                const value = this.element.value;

                for (const validator of this.validators) {
                  const result = validator.validate(value);
                  if (!result.isValid) {
                    this.showError(result.message);
                    return ValidationResult.error(`${this.label}: ${result.message}`);
                  }
                }

                this.hideError();
                return ValidationResult.success();
              }

              /**
               * ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
               */
              showError(message) {
                if (this.element) {
                  this.element.classList.add("error");
                }
                if (this.errorElement) {
                  this.errorElement.textContent = message;
                  this.errorElement.style.display = "block";
                }
              }

              /**
               * ã‚¨ãƒ©ãƒ¼éè¡¨ç¤º
               */
              hideError() {
                if (this.element) {
                  this.element.classList.remove("error");
                }
                if (this.errorElement) {
                  this.errorElement.style.display = "none";
                }
              }

              /**
               * å€¤ã‚’å–å¾—
               */
              getValue() {
                return this.element ? this.element.value : "";
              }

              /**
               * å€¤ã‚’è¨­å®š
               */
              setValue(value) {
                if (this.element) {
                  this.element.value = value;
                }
              }
            }

            /**
             * éƒµä¾¿ç•ªå·ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆä½æ‰€æ¤œç´¢æ©Ÿèƒ½ä»˜ãï¼‰ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
             */
            class PostalCodeField extends FormField {
              constructor(elementId, label, addressFieldId) {
                super(elementId, label);
                this.addressFieldId = addressFieldId;
                this.addressField = document.getElementById(addressFieldId);
                this.searchButton = document.getElementById("search_address_btn");

                this.setupPostalCodeFeatures();
              }

              setupPostalCodeFeatures() {
                if (this.searchButton) {
                  this.searchButton.addEventListener("click", () => {
                    this.searchAddress();
                  });
                }

                if (this.element) {
                  this.element.addEventListener("keypress", (e) => {
                    if (e.key === "Enter") {
                      e.preventDefault();
                      this.searchAddress();
                    }
                  });
                }
              }

              async searchAddress() {
                const postalCode = this.element.value.trim();

                // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
                this.hideError();

                // éƒµä¾¿ç•ªå·ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
                if (!/^\d{7}$/.test(postalCode)) {
                  this.showError("éƒµä¾¿ç•ªå·ã¯åŠè§’æ•°å­—7æ¡ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                  return;
                }

                // éƒµä¾¿ç•ªå·æ¤œç´¢APIã‚’ä½¿ç”¨
                const url = `https://zipcloud.ibsnet.co.jp/api/search?zipcode=${postalCode}`;

                if (this.searchButton) {
                  this.searchButton.textContent = "æ¤œç´¢ä¸­...";
                  this.searchButton.disabled = true;
                }

                        try {
                const response = await fetch(url);

                // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒæ­£å¸¸ã§ãªã„å ´åˆ
                if (!response.ok) {
                  throw new Error(`HTTP Error: ${response.status}`);
                }

                const data = await response.json();

                if (data.status === 200 && data.results && data.results.length > 0) {
                  const result = data.results[0];
                  if (this.addressField) {
                    this.addressField.value = `${result.address1}${result.address2}${result.address3}`;
                  }
                  this.showError("ä½æ‰€ãŒè‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã—ãŸã€‚", "green");
                } else {
                  this.showError(data.message || "è©²å½“ã™ã‚‹ä½æ‰€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚");
                  if (this.addressField) {
                    this.addressField.value = "";
                  }
                }
              } catch (error) {
                console.error("ä½æ‰€æ¤œç´¢ã‚¨ãƒ©ãƒ¼:", error);

                // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã‹ã©ã†ã‹ã‚’åˆ¤å®š
                const isNetworkError = error instanceof TypeError ||
                                      error.name === 'NetworkError' ||
                                      error.message.includes('Failed to fetch') ||
                                      error.message.includes('Network request failed') ||
                                      error.message.includes('HTTP Error');

                if (isNetworkError) {
                  this.showError("ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ä½æ‰€æ¤œç´¢æ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã›ã‚“ã€‚ä½æ‰€ã‚’æ‰‹å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                } else {
                  this.showError("ä½æ‰€æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
                }
              } finally {
                  if (this.searchButton) {
                    this.searchButton.textContent = "ä½æ‰€æ¤œç´¢";
                    this.searchButton.disabled = false;
                  }
                }
              }

              showError(message, color = "#dc3545") {
                if (this.element) {
                  // æˆåŠŸæ™‚ï¼ˆç·‘è‰²ï¼‰ã®å ´åˆã¯errorã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ãªã„
                  if (color === "green" || color === "#28a745") {
                    this.element.classList.remove("error");
                  } else {
                    this.element.classList.add("error");
                  }
                }
                if (this.errorElement) {
                  this.errorElement.textContent = message;
                  this.errorElement.style.color = color;
                  this.errorElement.style.display = "block";
                }
              }
            }

            /**
             * ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³å¿…é ˆãƒãƒªãƒ‡ãƒ¼ã‚¿ãƒ¼
             */
            class RadioRequiredValidator extends Validator {
              constructor(radioName) {
                super("ã„ãšã‚Œã‹ã®é¸æŠè‚¢ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
                this.radioName = radioName;
              }

              validate(value) {
                // åŒã˜nameã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ã„ãšã‚Œã‹ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                const radios = document.querySelectorAll(`input[name="${this.radioName}"]`);
                const hasChecked = Array.from(radios).some((radio) => radio.checked);

                return hasChecked ? ValidationResult.success() : ValidationResult.error(this.errorMessage);
              }
            }

            /**
             * ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ç¾¤ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
             */
            class RadioField {
              constructor(radioName, label) {
                this.radioName = radioName;
                this.label = label;
                this.radioElements = Array.from(document.querySelectorAll(`input[name="${radioName}"]`));
                this.errorElement = document.getElementById(radioName + "_error");
                this.validators = [];

                this.setupEventListeners();
              }

              addValidator(validator) {
                this.validators.push(validator);
                return this;
              }

              setupEventListeners() {
                console.log(`RadioField (${this.radioName}) ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®šä¸­...`);
                this.radioElements.forEach((radio) => {
                  radio.addEventListener("change", () => {
                    console.log(`ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ (${this.radioName}) ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸ`);
                    this.validateRealtime();

                    // å­¦æ­´é¸æŠã®å ´åˆã¯è¡¨ç¤ºåˆ¶å¾¡ã‚’å®Ÿè¡Œ
                    if (this.radioName === "education_level") {
                      console.log("å­¦æ­´é¸æŠãŒå¤‰æ›´ã•ã‚ŒãŸãŸã‚ã€updateFormVisibility ã‚’å®Ÿè¡Œ");
                      updateFormVisibility();
                    }
                  });
                });
              }

              validateRealtime() {
                for (const validator of this.validators) {
                  const result = validator.validate("");
                  if (!result.isValid) {
                    this.showError(result.message);
                    return;
                  }
                }
                this.hideError();
              }

              validate() {
                for (const validator of this.validators) {
                  const result = validator.validate("");
                  if (!result.isValid) {
                    this.showError(result.message);
                    return ValidationResult.error(`${this.label}: ${result.message}`);
                  }
                }
                this.hideError();
                return ValidationResult.success();
              }

              showError(message) {
                this.radioElements.forEach((radio) => {
                  radio.classList.add("error");
                });
                if (this.errorElement) {
                  this.errorElement.textContent = message;
                  this.errorElement.style.display = "block";
                }
              }

              hideError() {
                this.radioElements.forEach((radio) => {
                  radio.classList.remove("error");
                });
                if (this.errorElement) {
                  this.errorElement.style.display = "none";
                }
              }

              getValue() {
                const checkedRadio = this.radioElements.find((radio) => radio.checked);
                if (checkedRadio) {
                  const label = document.querySelector(`label[for="${checkedRadio.id}"]`);
                  return label ? label.textContent : checkedRadio.value;
                }
                return "";
              }

              getValueCode() {
                const checkedRadio = this.radioElements.find((radio) => radio.checked);
                return checkedRadio ? checkedRadio.value : "";
              }
            }

            /**
             * ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ç¾¤ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
             */
            class CheckboxField {
              constructor(checkboxIds, label) {
                this.checkboxIds = checkboxIds;
                this.label = label;
                this.checkboxElements = checkboxIds.map((id) => document.getElementById(id)).filter((el) => el !== null);
                this.errorElement = document.getElementById("toshin_zaisekireki_error");
                this.validators = [];

                this.setupEventListeners();
              }

              addValidator(validator) {
                this.validators.push(validator);
                return this;
              }

              setupEventListeners() {
                this.checkboxElements.forEach((checkbox) => {
                  checkbox.addEventListener("change", () => {
                    this.validateRealtime();
                  });
                });
              }

              validateRealtime() {
                for (const validator of this.validators) {
                  const result = validator.validate("");
                  if (!result.isValid) {
                    this.showError(result.message);
                    return;
                  }
                }
                this.hideError();
              }

              validate() {
                for (const validator of this.validators) {
                  const result = validator.validate("");
                  if (!result.isValid) {
                    this.showError(result.message);
                    return ValidationResult.error(`${this.label}: ${result.message}`);
                  }
                }
                this.hideError();
                return ValidationResult.success();
              }

              showError(message) {
                this.checkboxElements.forEach((checkbox) => {
                  checkbox.classList.add("error");
                });
                if (this.errorElement) {
                  this.errorElement.textContent = message;
                  this.errorElement.style.display = "block";
                }
              }

              hideError() {
                this.checkboxElements.forEach((checkbox) => {
                  checkbox.classList.remove("error");
                });
                if (this.errorElement) {
                  this.errorElement.style.display = "none";
                }
              }

              getValue() {
                const checkedValues = [];
                this.checkboxElements.forEach((checkbox, index) => {
                  if (checkbox.checked) {
                    checkedValues.push(checkbox.nextElementSibling.textContent);
                  }
                });
                return checkedValues.join(", ");
              }
            }

            /**
             * ãƒ•ã‚©ãƒ¼ãƒ å…¨ä½“ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
             */
            class FormManager {
              constructor(formId) {
                this.formId = formId;
                this.formElement = document.getElementById(formId);
                this.fields = new Map();
                this.checkboxFields = new Map();
                this.radioFields = new Map();
                this.validationErrorsElement = document.getElementById("validation-errors");
                this.validationErrorsListElement = document.getElementById("validation-errors-list");
              }

              /**
               * ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
               */
              addField(field) {
                if (field instanceof CheckboxField) {
                  this.checkboxFields.set(field.label, field);
                } else if (field instanceof RadioField) {
                  this.radioFields.set(field.label, field);
                } else {
                  this.fields.set(field.elementId, field);
                }
                return this;
              }

              /**
               * ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ï¼ˆåˆ¥åãƒ¡ã‚½ãƒƒãƒ‰ï¼‰
               */
              addCheckboxField(field) {
                this.checkboxFields.set(field.label, field);
                return this;
              }

              /**
               * ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
               */
              addRadioField(field) {
                this.radioFields.set(field.label, field);
                return this;
              }

              /**
               * å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
               */
              validateAll() {
                const errors = [];

                // é€šå¸¸ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                for (const [id, field] of this.fields) {
                  const result = field.validate();
                  if (!result.isValid) {
                    errors.push(result.message);
                  }
                }

                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                for (const [label, field] of this.checkboxFields) {
                  const result = field.validate();
                  if (!result.isValid) {
                    errors.push(result.message);
                  }
                }

                // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                for (const [label, field] of this.radioFields) {
                  const result = field.validate();
                  if (!result.isValid) {
                    errors.push(result.message);
                  }
                }

                if (errors.length > 0) {
                  this.showValidationErrors(errors);
                  return false;
                } else {
                  this.hideValidationErrors();
                  return true;
                }
              }

              /**
               * ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
               */
              showValidationErrors(errors) {
                if (this.validationErrorsListElement) {
                  let html = "<ul>";
                  errors.forEach((error) => {
                    html += `<li>${error}</li>`;
                  });
                  html += "</ul>";
                  this.validationErrorsListElement.innerHTML = html;
                }

                if (this.validationErrorsElement) {
                  this.validationErrorsElement.style.display = "block";
                  this.validationErrorsElement.scrollIntoView({ behavior: "smooth", block: "center" });
                }
              }

              /**
               * ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼éè¡¨ç¤º
               */
              hideValidationErrors() {
                if (this.validationErrorsElement) {
                  this.validationErrorsElement.style.display = "none";
                }
              }

              /**
               * ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
               */
              getFormData() {
                const data = {};

                // é€šå¸¸ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
                for (const [id, field] of this.fields) {
                  data[id] = field.getValue();
                }

                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
                for (const [label, field] of this.checkboxFields) {
                  data[label] = field.getValue();
                }

                // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
                for (const [label, field] of this.radioFields) {
                  data[label] = field.getValue();
                }

                return data;
              }

              /**
               * å¤–éƒ¨ã‹ã‚‰å—ã‘å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦è¨­å®š
               *
               * ã“ã®é–¢æ•°ã¯ã€å¤–éƒ¨ã‚½ãƒ¼ã‚¹ã‹ã‚‰æä¾›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ å†…ã®å„å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«
               * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚é€šå¸¸ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦ã¯ã€å¯¾å¿œã™ã‚‹
               * ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ãã®å€¤ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚»ãƒƒãƒˆã—ã¾ã™ã€‚
               */
              setFormData(data) {
                // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦ã€å¯¾å¿œã™ã‚‹å€¤ã‚’è¨­å®š
                for (const [id, field] of this.fields) {
                  if (data[id] !== undefined) {
                    field.setValue(data[id]);
                  }
                }

                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯è¨­å®šå‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆè¤‡é›‘ãªãŸã‚ï¼‰
                // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚‚è¨­å®šå‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆè¤‡é›‘ãªãŸã‚ï¼‰
              }
            }

            // ===== å…¥åŠ›å¤‰æ›å™¨ =====

            /**
             * åŠè§’æ•°å­—ã‚’å…¨è§’æ•°å­—ã«å¤‰æ›ï¼ˆä½æ‰€ãƒ»å»ºç‰©åç”¨ï¼‰
             */
            function toFullWidth(str) {
              return str.replace(/[0-9-]/g, function (s) {
                return String.fromCharCode(s.charCodeAt(0) + 65248);
              });
            }

            /**
             * å…¨è§’ãƒ»ã²ã‚‰ãŒãªã‚’åŠè§’ã‚«ã‚¿ã‚«ãƒŠã«å¤‰æ›
             */
            function toHalfWidthKana(str) {
              // ã²ã‚‰ãŒãªã‚’å…¨è§’ã‚«ã‚¿ã‚«ãƒŠã«å¤‰æ›
              str = str.replace(/[\u3041-\u3096]/g, function (match) {
                const code = match.charCodeAt(0) + 0x60;
                return String.fromCharCode(code);
              });

              // å…¨è§’ã‚«ã‚¿ã‚«ãƒŠã‚’åŠè§’ã‚«ã‚¿ã‚«ãƒŠã«å¤‰æ›
              const kanaMap = {
                ã‚¢: "ï½±",
                ã‚¤: "ï½²",
                ã‚¦: "ï½³",
                ã‚¨: "ï½´",
                ã‚ª: "ï½µ",
                ã‚«: "ï½¶",
                ã‚­: "ï½·",
                ã‚¯: "ï½¸",
                ã‚±: "ï½¹",
                ã‚³: "ï½º",
                ã‚µ: "ï½»",
                ã‚·: "ï½¼",
                ã‚¹: "ï½½",
                ã‚»: "ï½¾",
                ã‚½: "ï½¿",
                ã‚¿: "ï¾€",
                ãƒ: "ï¾",
                ãƒ„: "ï¾‚",
                ãƒ†: "ï¾ƒ",
                ãƒˆ: "ï¾„",
                ãƒŠ: "ï¾…",
                ãƒ‹: "ï¾†",
                ãƒŒ: "ï¾‡",
                ãƒ: "ï¾ˆ",
                ãƒ: "ï¾‰",
                ãƒ: "ï¾Š",
                ãƒ’: "ï¾‹",
                ãƒ•: "ï¾Œ",
                ãƒ˜: "ï¾",
                ãƒ›: "ï¾",
                ãƒ: "ï¾",
                ãƒŸ: "ï¾",
                ãƒ : "ï¾‘",
                ãƒ¡: "ï¾’",
                ãƒ¢: "ï¾“",
                ãƒ¤: "ï¾”",
                ãƒ¦: "ï¾•",
                ãƒ¨: "ï¾–",
                ãƒ©: "ï¾—",
                ãƒª: "ï¾˜",
                ãƒ«: "ï¾™",
                ãƒ¬: "ï¾š",
                ãƒ­: "ï¾›",
                ãƒ¯: "ï¾œ",
                ãƒ²: "ï½¦",
                ãƒ³: "ï¾",
                ã‚¬: "ï½¶ï¾",
                ã‚®: "ï½·ï¾",
                ã‚°: "ï½¸ï¾",
                ã‚²: "ï½¹ï¾",
                ã‚´: "ï½ºï¾",
                ã‚¶: "ï½»ï¾",
                ã‚¸: "ï½¼ï¾",
                ã‚º: "ï½½ï¾",
                ã‚¼: "ï½¾ï¾",
                ã‚¾: "ï½¿ï¾",
                ãƒ€: "ï¾€ï¾",
                ãƒ‚: "ï¾ï¾",
                ãƒ…: "ï¾‚ï¾",
                ãƒ‡: "ï¾ƒï¾",
                ãƒ‰: "ï¾„ï¾",
                ãƒ: "ï¾Šï¾",
                ãƒ“: "ï¾‹ï¾",
                ãƒ–: "ï¾Œï¾",
                ãƒ™: "ï¾ï¾",
                ãƒœ: "ï¾ï¾",
                ãƒ‘: "ï¾Šï¾Ÿ",
                ãƒ”: "ï¾‹ï¾Ÿ",
                ãƒ—: "ï¾Œï¾Ÿ",
                ãƒš: "ï¾ï¾Ÿ",
                ãƒ: "ï¾ï¾Ÿ",
                ãƒ£: "ï½¬",
                ãƒ¥: "ï½­",
                ãƒ§: "ï½®",
                ãƒƒ: "ï½¯",
                ãƒ¼: "ï½°",
                ãƒ´: "ï½³ï¾",
                ã‚¡: "ï½§",
                ã‚£: "ï½¨",
                ã‚¥: "ï½©",
                ã‚§: "ï½ª",
                ã‚©: "ï½«",
              };

              return str.replace(/[\u30A1-\u30FF]/g, function (match) {
                return kanaMap[match] || match;
              });
            }

            /**
             * å…¨è§’æ•°å­—ãƒ»å…¨è§’ãƒã‚¤ãƒ•ãƒ³ã‚’åŠè§’æ•°å­—ãƒ»åŠè§’ãƒã‚¤ãƒ•ãƒ³ã«å¤‰æ›
             */
            function toHalfWidthNumber(str) {
              return str.replace(/[ï¼-ï¼™ï¼]/g, function (match) {
                if (match === "ï¼") {
                  return "-";
                }
                return String.fromCharCode(match.charCodeAt(0) - 65248);
              });
            }

            // ===== ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸåŒ– =====

            document.addEventListener("DOMContentLoaded", function () {
              // FormManagerã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
              const formManager = new FormManager("MainForm");

              // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¨­å®š
              formManager
                // åŸºæœ¬æƒ…å ±
                .addField(new FormField("name_1", "å§“").addValidator(new RequiredValidator()))
                .addField(new FormField("name_2", "å").addValidator(new RequiredValidator()))
                .addField(
                  new FormField("name_1_kana", "å§“ï¼ˆã‚«ãƒŠï¼‰")
                    .addValidator(new RequiredValidator())
                    .addValidator(new RegexValidator(VALIDATION_PATTERNS.KANA.regex, VALIDATION_PATTERNS.KANA.message))
                    .addInputTransformer(toHalfWidthKana)
                )
                .addField(
                  new FormField("name_2_kana", "åï¼ˆã‚«ãƒŠï¼‰")
                    .addValidator(new RequiredValidator())
                    .addValidator(new RegexValidator(VALIDATION_PATTERNS.KANA.regex, VALIDATION_PATTERNS.KANA.message))
                    .addInputTransformer(toHalfWidthKana)
                )
                .addField(new FormField("id_sex", "æ€§åˆ¥").addValidator(new RequiredValidator()))
                .addField(new FormField("birthday", "ç”Ÿå¹´æœˆæ—¥").addValidator(new RequiredValidator()))

                // ä½æ‰€æƒ…å ±
                .addField(
                  new PostalCodeField("address_num", "éƒµä¾¿ç•ªå·", "address_str")
                    .addValidator(new RequiredValidator())
                    .addValidator(
                      new RegexValidator(VALIDATION_PATTERNS.POSTAL_CODE.regex, VALIDATION_PATTERNS.POSTAL_CODE.message)
                    )
                    .addInputTransformer(toHalfWidthNumber)
                )
                .addField(
                  new FormField("address_str", "ä½æ‰€").addValidator(new RequiredValidator()).addInputTransformer(toFullWidth)
                )
                .addField(new FormField("address_str_building", "å»ºç‰©åãƒ»éƒ¨å±‹ç•ªå·").addInputTransformer(toFullWidth)) // å¿…é ˆã§ã¯ãªã„
                .addField(
                  new FormField("address_str_kana", "ä½æ‰€å»ºç‰©åãƒ•ãƒªã‚¬ãƒŠ")
                    .addValidator(new RequiredValidator())
                    .addValidator(new RegexValidator(VALIDATION_PATTERNS.KANA.regex, VALIDATION_PATTERNS.KANA.message))
                    .addInputTransformer(toHalfWidthKana)
                )

                // é›»è©±ç•ªå·
                .addField(
                  new FormField("tel_home", "é›»è©±ç•ªå·ï¼ˆè‡ªå®…ï¼‰")
                    .addValidator(new PhoneEitherRequiredValidator("tel_home", "tel_mobile"))
                    .addValidator(
                      new RegexValidator(VALIDATION_PATTERNS.HOME_PHONE.regex, VALIDATION_PATTERNS.HOME_PHONE.message)
                    )
                    .addInputTransformer(toHalfWidthNumber)
                )
                .addField(
                  new FormField("tel_mobile", "é›»è©±ç•ªå·ï¼ˆæºå¸¯ï¼‰")
                    .addValidator(new PhoneEitherRequiredValidator("tel_home", "tel_mobile"))
                    .addValidator(
                      new RegexValidator(VALIDATION_PATTERNS.MOBILE_PHONE.regex, VALIDATION_PATTERNS.MOBILE_PHONE.message)
                    )
                    .addInputTransformer(toHalfWidthNumber)
                )

                // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
                .addField(
                  new FormField("email_address", "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹")
                    .addValidator(new RequiredValidator())
                    .addValidator(new RegexValidator(VALIDATION_PATTERNS.EMAIL.regex, VALIDATION_PATTERNS.EMAIL.message))
                )

                // å­¦æ­´æƒ…å ±
                .addField(
                  new RadioField("education_level", "æœ€çµ‚å­¦æ­´").addValidator(new RadioRequiredValidator("education_level"))
                )

                // å¤§å­¦æƒ…å ±
                .addField(new FormField("daigaku", "å¤§å­¦").addValidator(new RequiredValidator()))
                .addField(new FormField("gakubu", "å­¦éƒ¨ãƒ»å­¦é¡ãƒ»ç§‘é¡ç­‰").addValidator(new RequiredValidator()))
                .addField(new FormField("gakka", "å­¦ç§‘").addValidator(new RequiredValidator()))
                .addField(new FormField("daigaku_nyugaku_bi", "å…¥å­¦å¹´æœˆæ—¥").addValidator(new RequiredValidator()))
                .addField(new FormField("daigakuin", "å¤§å­¦é™¢")) // å¿…é ˆã§ã¯ãªã„
                .addField(new FormField("kenkyuka", "ç ”ç©¶ç§‘")) // å¿…é ˆã§ã¯ãªã„
                .addField(new FormField("senkou", "å°‚æ”»")) // å¿…é ˆã§ã¯ãªã„

                // ãã®ä»–
                .addField(new FormField("koukou_name", "å‡ºèº«é«˜æ ¡").addValidator(new RequiredValidator()))
                .addField(
                  new RadioField("toshin_zaisekireki", "æ±é€²åœ¨ç±æ­´").addValidator(
                    new RadioRequiredValidator("toshin_zaisekireki")
                  )
                )

                // çµ¦ä¸å—å–å£åº§
                .addField(
                  new FormField("bank_code", "éŠ€è¡Œã‚³ãƒ¼ãƒ‰")
                    .addValidator(new RequiredValidator())
                    .addValidator(
                      new RegexValidator(VALIDATION_PATTERNS.BANK_CODE.regex, VALIDATION_PATTERNS.BANK_CODE.message)
                    )
                    .addInputTransformer(toHalfWidthNumber)
                )
                .addField(new FormField("bank_name", "éŠ€è¡Œå").addValidator(new RequiredValidator()))
                .addField(
                  new FormField("branch_code", "æ”¯åº—ã‚³ãƒ¼ãƒ‰")
                    .addValidator(new RequiredValidator())
                    .addValidator(
                      new RegexValidator(VALIDATION_PATTERNS.BRANCH_CODE.regex, VALIDATION_PATTERNS.BRANCH_CODE.message)
                    )
                    .addInputTransformer(toHalfWidthNumber)
                )
                .addField(new FormField("branch_name", "æ”¯åº—å").addValidator(new RequiredValidator()))
                .addField(new FormField("account_type", "å£åº§ç¨®åˆ¥").addValidator(new RequiredValidator()))
                .addField(
                  new FormField("account_number", "å£åº§ç•ªå·")
                    .addValidator(new RequiredValidator())
                    .addValidator(
                      new RegexValidator(VALIDATION_PATTERNS.ACCOUNT_NUMBER.regex, VALIDATION_PATTERNS.ACCOUNT_NUMBER.message)
                    )
                    .addInputTransformer(toHalfWidthNumber)
                )
                .addField(
                  new FormField("account_holder", "å£åº§åç¾©äºº")
                    .addValidator(new RequiredValidator())
                    .addValidator(new AccountHolderMatchValidator("name_1", "name_2"))
                )
                .addField(
                  new FormField("account_holder_kana", "å£åº§åç¾©äººãƒ•ãƒªã‚¬ãƒŠ")
                    .addValidator(new RequiredValidator())
                    .addValidator(new RegexValidator(VALIDATION_PATTERNS.KANA.regex, VALIDATION_PATTERNS.KANA.message))
                    .addValidator(new AccountHolderKanaMatchValidator("name_1_kana", "name_2_kana"))
                    .addInputTransformer(toHalfWidthKana)
                );

              // ç¢ºèªãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
              document.getElementById("confirm-button").addEventListener("click", function () {
                console.log("ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹");

                if (formManager.validateAll()) {
                  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸæ™‚ã¯ç¢ºèªç”»é¢ã‚’è¡¨ç¤º
                  showConfirmation(formManager);
                } else {
                  console.log("ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ");
                }
              });

              // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
              document.getElementById("back-button").addEventListener("click", function () {
                backToInput();
              });

              // CSVãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
              document.getElementById("csv-button").addEventListener("click", function () {
                downloadCSV(formManager);
              });

              // å­¦æ­´é¸æŠã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ï¼ˆè£œå¼·ï¼‰
              const educationRadios = document.querySelectorAll('input[name="education_level"]');
              console.log(`æ•™è‚²ãƒ¬ãƒ™ãƒ«ã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’ ${educationRadios.length} å€‹ç™ºè¦‹ã—ã¾ã—ãŸ`);
              educationRadios.forEach((radio, index) => {
                console.log(`ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ ${index + 1} (ID: ${radio.id}) ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ `);
                radio.addEventListener("change", function () {
                  console.log(`è£œå¼·ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‹ã‚‰ updateFormVisibility ã‚’å®Ÿè¡Œ (é¸æŠ: ${this.value})`);
                  updateFormVisibility();
                });
              });

              // åˆæœŸè¡¨ç¤ºçŠ¶æ…‹ã‚’è¨­å®š
              console.log("åˆæœŸè¡¨ç¤ºçŠ¶æ…‹ã‚’è¨­å®šä¸­...");
              updateFormVisibility();

              console.log("ãƒ•ã‚©ãƒ¼ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ");
            });

            // ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±
            const FORM_VERSION = "1.0.0";

            // ===== å­¦æ­´ã«å¿œã˜ãŸè¡¨ç¤ºåˆ¶å¾¡ =====

            /**
             * å­¦æ­´é¸æŠã«å¿œã˜ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºã‚’åˆ¶å¾¡
             */
            function updateFormVisibility() {
              console.log("updateFormVisibility ãŒå‘¼ã°ã‚Œã¾ã—ãŸ");

              const educationLevel = document.querySelector('input[name="education_level"]:checked')?.value;
              console.log("é¸æŠã•ã‚ŒãŸå­¦æ­´ãƒ¬ãƒ™ãƒ«:", educationLevel);

              // å¤§å­¦ã«ã¤ã„ã¦ã®fieldsetã‚’æ¤œç´¢
              const allFieldsets = document.querySelectorAll("fieldset");
              let universityFieldset = null;
              for (const fieldset of allFieldsets) {
                const legend = fieldset.querySelector("legend");
                if (legend && legend.textContent.includes("å¤§å­¦ã«ã¤ã„ã¦")) {
                  universityFieldset = fieldset;
                  break;
                }
              }

              // å‡ºèº«é«˜æ ¡ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ¤œç´¢
              const allFormItems = document.querySelectorAll(".Form-Item");
              let highSchoolField = null;
              for (const item of allFormItems) {
                const label = item.querySelector(".Form-Item-Label");
                if (label && label.textContent.includes("å‡ºèº«é«˜æ ¡")) {
                  highSchoolField = item;
                  break;
                }
              }

              console.log("universityFieldset:", universityFieldset);
              console.log("highSchoolField:", highSchoolField);

              switch (educationLevel) {
                case "1": // å¤§å­¦
                  console.log("å¤§å­¦é¸æŠ - ã™ã¹ã¦è¡¨ç¤º");
                  // ã™ã¹ã¦è¡¨ç¤º
                  if (universityFieldset) {
                    universityFieldset.style.display = "block";
                    clearUniversityFields();
                  }
                  if (highSchoolField) {
                    highSchoolField.style.display = "block";
                    clearHighSchoolField();
                  }
                  break;

                case "2": // çŸ­å¤§ãƒ»å°‚é–€
                case "3": // é«˜æ ¡
                  console.log("çŸ­å¤§ãƒ»å°‚é–€ã¾ãŸã¯é«˜æ ¡é¸æŠ - å¤§å­¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³éè¡¨ç¤º");
                  // å¤§å­¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿éè¡¨ç¤º
                  if (universityFieldset) {
                    universityFieldset.style.display = "none";
                    fillUniversityFields();
                  }
                  if (highSchoolField) {
                    highSchoolField.style.display = "block";
                    clearHighSchoolField();
                  }
                  break;

                case "4": // ä¸­å­¦
                  console.log("ä¸­å­¦é¸æŠ - å¤§å­¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨å‡ºèº«é«˜æ ¡ã‚’éè¡¨ç¤º");
                  // å¤§å­¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨å‡ºèº«é«˜æ ¡ã‚’éè¡¨ç¤º
                  if (universityFieldset) {
                    universityFieldset.style.display = "none";
                    fillUniversityFields();
                  }
                  if (highSchoolField) {
                    highSchoolField.style.display = "none";
                    fillHighSchoolField();
                  }
                  break;

                default:
                  console.log("é¸æŠãªã— - ã™ã¹ã¦è¡¨ç¤º");
                  // é¸æŠãªã—ã®å ´åˆã¯ã™ã¹ã¦è¡¨ç¤º
                  if (universityFieldset) {
                    universityFieldset.style.display = "block";
                    clearUniversityFields();
                  }
                  if (highSchoolField) {
                    highSchoolField.style.display = "block";
                    clearHighSchoolField();
                  }
                  break;
              }
            }

            /**
             * å¤§å­¦é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€Œãªã—ã€ã¨ã€Œ0001/01/01ã€ã‚’è‡ªå‹•å…¥åŠ›
             */
            function fillUniversityFields() {
              console.log("å¤§å­¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è‡ªå‹•å…¥åŠ›å®Ÿè¡Œ");
              const textFields = ["daigaku", "gakubu", "gakka", "daigakuin", "kenkyuka", "senkou"];
              const dateFields = ["daigaku_nyugaku_bi"];

              textFields.forEach((fieldId) => {
                const element = document.getElementById(fieldId);
                if (element) {
                  element.value = "ãªã—";
                  console.log(`${fieldId} ã« "ãªã—" ã‚’å…¥åŠ›`);
                } else {
                  console.log(`${fieldId} è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
                }
              });

              dateFields.forEach((fieldId) => {
                const element = document.getElementById(fieldId);
                if (element) {
                  element.value = "0001-01-01";
                  console.log(`${fieldId} ã« "0001-01-01" ã‚’å…¥åŠ›`);
                } else {
                  console.log(`${fieldId} è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
                }
              });
            }

            /**
             * å¤§å­¦é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªã‚¢
             */
            function clearUniversityFields() {
              console.log("å¤§å­¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªã‚¢å®Ÿè¡Œ");
              const allFields = ["daigaku", "gakubu", "gakka", "daigaku_nyugaku_bi", "daigakuin", "kenkyuka", "senkou"];

              allFields.forEach((fieldId) => {
                const element = document.getElementById(fieldId);
                if (element) {
                  element.value = "";
                  console.log(`${fieldId} ã‚’ã‚¯ãƒªã‚¢`);
                }
              });
            }

            /**
             * å‡ºèº«é«˜æ ¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€Œãªã—ã€ã‚’è‡ªå‹•å…¥åŠ›
             */
            function fillHighSchoolField() {
              console.log("å‡ºèº«é«˜æ ¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è‡ªå‹•å…¥åŠ›å®Ÿè¡Œ");
              const element = document.getElementById("koukou_name");
              if (element) {
                element.value = "ãªã—";
                console.log('koukou_name ã« "ãªã—" ã‚’å…¥åŠ›');
              } else {
                console.log("koukou_name è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
              }
            }

            /**
             * å‡ºèº«é«˜æ ¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªã‚¢
             */
            function clearHighSchoolField() {
              console.log("å‡ºèº«é«˜æ ¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªã‚¢å®Ÿè¡Œ");
              const element = document.getElementById("koukou_name");
              if (element) {
                element.value = "";
                console.log("koukou_name ã‚’ã‚¯ãƒªã‚¢");
              }
            }

            // ç¢ºèªç”»é¢è¡¨ç¤ºæ©Ÿèƒ½
            function showConfirmation(formManager) {
              // å…¥åŠ›å†…å®¹ã‚’åé›†
              const formData = collectFormData(formManager);

              // ç¢ºèªç”»é¢ã®HTMLã‚’ç”Ÿæˆ
              const confirmationHTML = generateConfirmationHTML(formData);

              // ç¢ºèªç”»é¢ã«è¡¨ç¤º
              document.getElementById("confirmationData").innerHTML = confirmationHTML;

              // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€šçŸ¥ã‚’éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆå‰å›ã®é€šçŸ¥ãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆï¼‰
              hideDownloadNotification();

              // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
              document.querySelector(".Form").style.display = "none";
              document.getElementById("confirmationScreen").style.display = "block";

              // ç¢ºèªç”»é¢ã®å…ˆé ­ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
              document.getElementById("confirmationScreen").scrollIntoView({ behavior: "smooth" });
            }

            // å…¥åŠ›ç”»é¢ã«æˆ»ã‚‹
            function backToInput() {
              document.getElementById("confirmationScreen").style.display = "none";
              document.querySelector(".Form").style.display = "block";

              // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€šçŸ¥ã‚’éè¡¨ç¤ºã«ã™ã‚‹
              hideDownloadNotification();

              // å…¥åŠ›ç”»é¢ã®å…ˆé ­ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
              document.querySelector(".Form").scrollIntoView({ behavior: "smooth" });
            }

            // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿åé›†
            function collectFormData(formManager) {
              // æ±é€²åœ¨ç±æ­´ã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³å€¤ã‚’å–å¾—
              function getToshinZaisekireki(value) {
                switch (value) {
                  case "1":
                    return "ã‚ã‚Š";
                  case "2":
                    return "ãªã—";
                  default:
                    return "";
                }
              }

              // å£åº§ç¨®åˆ¥ã®å€¤ã‚’æ–‡å­—åˆ—ã«å¤‰æ›
              function getAccountType(value) {
                switch (value) {
                  case "1":
                    return "æ™®é€šé é‡‘";
                  case "2":
                    return "å½“åº§é é‡‘";
                  default:
                    return "";
                }
              }

              // æ€§åˆ¥ã®å€¤ã‚’æ–‡å­—åˆ—ã«å¤‰æ›
              function getSex(value) {
                switch (value) {
                  case "1":
                    return "ç”·æ€§";
                  case "2":
                    return "å¥³æ€§";
                  default:
                    return "";
                }
              }

              // å­¦æ­´ã®å€¤ã‚’æ–‡å­—åˆ—ã«å¤‰æ›
              function getEducationLevel(value) {
                switch (value) {
                  case "1":
                    return "1.å¤§å­¦ãƒ»å¤§å­¦é™¢ãƒ»å¤§å­¦ç”Ÿãƒ»å¤§å­¦é™¢ç”Ÿãƒ»å¤§å­¦å…¥å­¦äºˆå®š";
                  case "2":
                    return "2.çŸ­å¤§ãƒ»å°‚é–€å­¦æ ¡";
                  case "3":
                    return "3.é«˜ç­‰å­¦æ ¡å’æ¥­ãƒ»é«˜æ ¡ç”Ÿ";
                  case "4":
                    return "4.ä¸­å­¦æ ¡å’æ¥­";
                  default:
                    return "";
                }
              }

              // å€¤ã®ãƒˆãƒªãƒ å‡¦ç†ã‚’è¡Œã†ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
              function trimValue(value) {
                if (typeof value === "string") {
                  // åŠè§’ãƒ»å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»
                  return value.replace(/^[\sã€€]+|[\sã€€]+$/g, "");
                }
                return value;
              }

              // æ—¥ä»˜ã‚’yyyy/mm/ddå½¢å¼ã«å¤‰æ›ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
              function formatDate(value) {
                if (!value || value.trim() === "") {
                  return "";
                }
                // YYYY-MM-DDå½¢å¼ã‚’YYYY/MM/DDå½¢å¼ã«å¤‰æ›
                return value.replace(/-/g, "/");
              }

              return {
                ãƒãƒ¼ã‚¸ãƒ§ãƒ³: FORM_VERSION,
                ä½œæˆæ—¥æ™‚: new Date().toLocaleString("ja-JP"),
                å§“: trimValue(document.getElementById("name_1")?.value || ""),
                å: trimValue(document.getElementById("name_2")?.value || ""),
                å§“ãƒ•ãƒªã‚¬ãƒŠ: trimValue(document.getElementById("name_1_kana")?.value || ""),
                åãƒ•ãƒªã‚¬ãƒŠ: trimValue(document.getElementById("name_2_kana")?.value || ""),
                æ€§åˆ¥: getSex(document.getElementById("id_sex")?.value),
                ç”Ÿå¹´æœˆæ—¥: formatDate(document.getElementById("birthday")?.value || ""),
                éƒµä¾¿ç•ªå·: trimValue(document.getElementById("address_num")?.value || ""),
                ä½æ‰€: trimValue(document.getElementById("address_str")?.value || ""),
                å»ºç‰©åãƒ»éƒ¨å±‹ç•ªå·: trimValue(document.getElementById("address_str_building")?.value || ""),
                ä½æ‰€å»ºç‰©åãƒ•ãƒªã‚¬ãƒŠ: trimValue(document.getElementById("address_str_kana")?.value || ""),
                "é›»è©±ç•ªå·(è‡ªå®…)": trimValue(document.getElementById("tel_home")?.value || ""),
                "é›»è©±ç•ªå·(æºå¸¯)": trimValue(document.getElementById("tel_mobile")?.value || ""),
                ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: trimValue(document.getElementById("email_address")?.value || ""),
                æœ€çµ‚å­¦æ­´: getEducationLevel(document.querySelector('input[name="education_level"]:checked')?.value),
                å¤§å­¦: trimValue(document.getElementById("daigaku")?.value || ""),
                "å­¦éƒ¨ãƒ»å­¦é¡ãƒ»ç§‘é¡ç­‰": trimValue(document.getElementById("gakubu")?.value || ""),
                å­¦ç§‘: trimValue(document.getElementById("gakka")?.value || ""),
                å…¥å­¦å¹´æœˆæ—¥: formatDate(document.getElementById("daigaku_nyugaku_bi")?.value || ""),
                å¤§å­¦é™¢: trimValue(document.getElementById("daigakuin")?.value || ""),
                ç ”ç©¶ç§‘: trimValue(document.getElementById("kenkyuka")?.value || ""),
                å°‚æ”»: trimValue(document.getElementById("senkou")?.value || ""),
                å‡ºèº«é«˜æ ¡: trimValue(document.getElementById("koukou_name")?.value || ""),
                æ±é€²åœ¨ç±æ­´: getToshinZaisekireki(document.querySelector('input[name="toshin_zaisekireki"]:checked')?.value),
                éŠ€è¡Œã‚³ãƒ¼ãƒ‰: trimValue(document.getElementById("bank_code")?.value || ""),
                éŠ€è¡Œå: trimValue(document.getElementById("bank_name")?.value || ""),
                æ”¯åº—ã‚³ãƒ¼ãƒ‰: trimValue(document.getElementById("branch_code")?.value || ""),
                æ”¯åº—å: trimValue(document.getElementById("branch_name")?.value || ""),
                å£åº§ç¨®åˆ¥: getAccountType(document.getElementById("account_type")?.value),
                å£åº§ç•ªå·: trimValue(document.getElementById("account_number")?.value || ""),
                å£åº§åç¾©äºº: trimValue(document.getElementById("account_holder")?.value || ""),
                å£åº§åç¾©äººãƒ•ãƒªã‚¬ãƒŠ: trimValue(document.getElementById("account_holder_kana")?.value || ""),
              };
            }

            // ç¢ºèªç”»é¢HTMLç”Ÿæˆ
            function generateConfirmationHTML(data) {
              let html = '<table class="confirmation-table">';

              // å­¦æ­´ã«å¿œã˜ã¦è¡¨ç¤ºã™ã‚‹é …ç›®ã‚’æ±ºå®š
              const educationLevel = document.querySelector('input[name="education_level"]:checked')?.value;
              const hiddenUniversityFields = ["å¤§å­¦", "å­¦éƒ¨ãƒ»å­¦é¡ãƒ»ç§‘é¡ç­‰", "å­¦ç§‘", "å…¥å­¦å¹´æœˆæ—¥", "å¤§å­¦é™¢", "ç ”ç©¶ç§‘", "å°‚æ”»"];
              const hiddenHighSchoolFields = ["å‡ºèº«é«˜æ ¡"];

              for (const [key, value] of Object.entries(data)) {
                // ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ç¢ºèªç”»é¢ã§ã¯éè¡¨ç¤º
                if (key === "ãƒãƒ¼ã‚¸ãƒ§ãƒ³") continue;

                // å­¦æ­´ã«å¿œã˜ã¦éè¡¨ç¤ºã«ã™ã‚‹é …ç›®ã‚’ã‚¹ã‚­ãƒƒãƒ—
                let shouldHide = false;

                if (educationLevel === "2" || educationLevel === "3") {
                  // çŸ­å¤§ãƒ»å°‚é–€ã€é«˜æ ¡ã®å ´åˆï¼šå¤§å­¦é–¢é€£é …ç›®ã‚’éè¡¨ç¤º
                  if (hiddenUniversityFields.includes(key)) {
                    shouldHide = true;
                  }
                } else if (educationLevel === "4") {
                  // ä¸­å­¦ã®å ´åˆï¼šå¤§å­¦é–¢é€£é …ç›®ã¨å‡ºèº«é«˜æ ¡ã‚’éè¡¨ç¤º
                  if (hiddenUniversityFields.includes(key) || hiddenHighSchoolFields.includes(key)) {
                    shouldHide = true;
                  }
                }

                if (!shouldHide && value && value.trim() !== "") {
                  html += `
                              <tr>
                                  <td>${key}</td>
                                  <td>${value}</td>
                              </tr>
                          `;
                }
              }

              html += "</table>";
              return html;
            }

            // CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
            async function downloadCSV(formManager) {
              // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’åé›†
              const formData = collectFormData(formManager);

              // CSVãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
              const headers = Object.keys(formData);
              const values = Object.values(formData);

              // CSVã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½œæˆï¼ˆBOMä»˜ãUTF-8ï¼‰
              let csvContent = "\uFEFF"; // BOM
              // 1è¡Œç›®ï¼šè¦‹å‡ºã—
              csvContent += headers.map((header) => `"${header}"`).join(",") + "\n";
              // 2è¡Œç›®ï¼šå€¤
              csvContent += values.map((value) => `"${value.toString().replace(/"/g, '""')}"`).join(",") + "\n";

              // ãƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆ
              const lastName = formData["å§“"] || "unnamed";
              const firstName = formData["å"] || "";
              const name = lastName + firstName;
              // ãƒ•ã‚¡ã‚¤ãƒ«åã«ä½¿ç”¨ã§ããªã„æ–‡å­—ã‚’_ã«å¤‰æ›
              const sanitizedName = name.replace(/[<>:"/\\|?*]/g, "_").substring(0, 200);
              const fileName = `${sanitizedName}_å¿œå‹Ÿè€…æƒ…å ±æå‡ºã‚·ãƒ¼ãƒˆ.csv`;

              try {
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†å®Ÿè¡Œ
                const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
                const link = document.createElement("a");

                if (link.download !== undefined) {
                  const url = URL.createObjectURL(blob);
                  link.setAttribute("href", url);
                  link.setAttribute("download", fileName);
                  link.style.visibility = "hidden";
                  document.body.appendChild(link);
                  link.click();
                  document.body.removeChild(link);
                  URL.revokeObjectURL(url);

                  // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†ãŒå®Ÿè¡Œã•ã‚ŒãŸã“ã¨ã‚’é€šçŸ¥
                  showDownloadAttemptNotification(fileName);
                } else {
                  showDownloadErrorNotification("ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
                }
              } catch (error) {
                showDownloadErrorNotification("CSVãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š" + error.message);
              }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†å®Ÿè¡Œé€šçŸ¥ã‚’è¡¨ç¤º
            function showDownloadAttemptNotification(fileName) {
              const notification = document.getElementById("download-notification");
              const filenameDiv = document.getElementById("download-filename");

              // ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚’éè¡¨ç¤ºã«ã™ã‚‹
              const errorNotification = document.getElementById("download-error-notification");
              if (errorNotification) {
                errorNotification.style.display = "none";
              }

              if (notification && filenameDiv) {
                filenameDiv.textContent = `ãƒ•ã‚¡ã‚¤ãƒ«å: ${fileName}`;
                notification.style.display = "block";

                // é€šçŸ¥ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                notification.scrollIntoView({ behavior: "smooth", block: "center" });
              }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€šçŸ¥ã‚’è¡¨ç¤ºï¼ˆå¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ï¼‰
            function showDownloadNotification(fileName) {
              showDownloadAttemptNotification(fileName);
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€šçŸ¥ã‚’éè¡¨ç¤º
            function hideDownloadNotification() {
              const notification = document.getElementById("download-notification");
              const errorNotification = document.getElementById("download-error-notification");

              if (notification) {
                notification.style.display = "none";
              }
              if (errorNotification) {
                errorNotification.style.display = "none";
              }
            }

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¤±æ•—é€šçŸ¥ã‚’è¡¨ç¤º
            function showDownloadErrorNotification(errorMessage) {
              const errorNotification = document.getElementById("download-error-notification");
              const errorMessageDiv = document.getElementById("download-error-message");

              // æˆåŠŸé€šçŸ¥ã‚’éè¡¨ç¤ºã«ã™ã‚‹
              const successNotification = document.getElementById("download-notification");
              if (successNotification) {
                successNotification.style.display = "none";
              }

              if (errorNotification && errorMessageDiv) {
                errorMessageDiv.textContent = errorMessage;
                errorNotification.style.display = "block";

                // é€šçŸ¥ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                errorNotification.scrollIntoView({ behavior: "smooth", block: "center" });
              }
            }
    </script>
  </body>
</html>
